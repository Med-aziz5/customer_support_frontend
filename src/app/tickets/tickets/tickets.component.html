<!-- AGENT / ADMIN VIEW -->
<div *ngIf="role !== 'CLIENT'" class="agent-admin-tickets">

  <!-- Show success message -->
  <div *ngIf="message" class="success-message">{{ message }}</div>

  <!-- Toggle checkbox -->
  <div class="filter-bar">
    <label>
      <input type="checkbox" [(ngModel)]="showAssignedOnly" (change)="toggleAssignedTickets()" />
      Show only my tickets
    </label>
  </div>

  <table>
    <thead>
      <tr>
        <th>Title</th>
        <th>Description</th>
        <th>Category</th>
        <th>Priority</th>
        <th>Status</th>
        <th>User ID</th>
        <th>Assigned To</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let ticket of tickets">
        <td>{{ ticket.title }}</td>
        <td>{{ ticket.description }}</td>
        <td>{{ ticket.category }}</td>
        <td>{{ ticket.priority }}</td>
        <td>{{ ticket.status }}</td>
        <td>{{ ticket.user_id }}</td>
        <td>{{ ticket.assigned_to || 'Unassigned' }}</td>
        <td>
          <!-- Assign to self -->
          <button *ngIf="role === 'AGENT' || role === 'ADMIN'" (click)="assignToSelf(ticket.id)">
            Assign to Self
          </button>

          <!-- Assign to another agent (ADMIN only) -->
          <div *ngIf="role === 'ADMIN'" class="assign-admin">
            <input type="number" placeholder="Agent ID" [formControl]="assignForm.controls['agentId']"/>
            <button (click)="assignToAgent(ticket.id)">Assign</button>
          </div>
        </td>
        <td>
          <!-- Delete button for Admin -->
          <button *ngIf="role === 'ADMIN'" (click)="deleteTicket(ticket.id)">
            Delete
          </button>
        </td>
      </tr>
    </tbody>
  </table>
</div>
